# Developer Guide

This guide provides information for developers working on the QLOP project.

## Updating the Project README

The main `README.md` file in the project root is auto-generated and should not be edited directly. It is compiled from a template and various dynamic and static content sources.

### Key Components

1.  **`README_TEMPLATE.md`**:
    *   Located in the project root.
    *   Defines the overall structure and layout of the final `README.md`.
    *   Contains placeholders (e.g., `{{project_overview}}`, `{{models_overview}}`) that are filled in by the generation script.

2.  **`generate_readme.py`**:
    *   Located in the project root.
    *   This Python script orchestrates the generation of `README.md`.
    *   It uses the `ReadmeGenerator` class.
    *   The `ReadmeGenerator.README_PLACEHOLDER_CONFIG` dictionary maps placeholders in the template to:
        *   Specific methods within the class for generating dynamic content.
        *   Paths to static Markdown files in `docs/sections/` whose content is injected.
        *   Direct string content (e.g., for simple links).

### Manual README Update

To manually update or regenerate `README.md` after making changes to the template, section files, or the script itself, run:

```bash
python generate_readme.py
```

This will overwrite the existing `README.md` with the newly generated content.

### Dynamic Content Sources

The `generate_readme.py` script dynamically populates several sections:

-   **Models Overview (`{{models_overview}}`)**:
    *   Generated by `_generate_models_overview()`.
    *   Scans the `models/` directory for `*.meta.json` files.
    *   Extracts information like model filename, timestamp, key metrics, and feature details.
    *   Formats this into a Markdown table.
-   **CLI Commands Summary (`{{cli_commands_summary}}`)**:
    *   Generated by `_generate_cli_commands_summary()`.
    *   Executes `python main.py --help` and parses the output to list available commands and their descriptions.
-   **Latest Evaluation Metrics (`{{latest_evaluation_metrics}}`)**:
    *   Generated by `_generate_latest_evaluation_metrics()`.
    *   Reads `logs/latest_eval_report.json`.
    *   Formats the report's content (model name, dataset, metrics, notes) into a Markdown summary.
    *   This section is conditionally rendered: if the report file is missing or doesn't contain expected data, the entire section will be hidden from `README.md`.
-   **Changelog Summary (`{{changelog_summary}}`)**:
    *   Generated by `_get_changelog_summary()`.
    *   Attempts to use `GitPython` to fetch recent commit history (hash, message, date, author).
    *   Falls back to parsing `git log` output if `GitPython` is unavailable.
    *   As a final fallback, it tries to read a `CHANGELOG.md` file if present.
-   **Other Placeholders**:
    *   `{{feature_list}}`, `{{examples_list}}`, `{{pipeline_status}}` are also filled by dedicated methods, currently returning placeholder text but designed for more dynamic content in the future.

### Pre-commit Hook

To automate README updates, a pre-commit hook is recommended. The `generate_readme.py` script prints conceptual setup instructions for `pre-commit`. This hook will automatically run `python generate_readme.py` before each commit if any relevant source files (template, sections, script, changelog, metrics/model metadata) have changed, ensuring `README.md` stays synchronized.

**Conceptual `.pre-commit-config.yaml` entry:**
```yaml
# ...
repos:
-   repo: local
    hooks:
    -   id: generate-readme
        name: Generate README.md
        entry: python generate_readme.py
        language: system
        files: ^README_TEMPLATE\.md$|^docs/sections/.*\.md$|^generate_readme\.py$|^CHANGELOG.md$|^logs/latest_eval_report.json$|^models/.*\.meta\.json$
        pass_filenames: false
        stages: [commit]
# ...
```
Install with `pip install pre-commit` and `pre-commit install`.

### Adding or Modifying Sections

1.  **Modify `README_TEMPLATE.md`**: Add or change placeholders and static text in the template to define the new structure.
2.  **Update `ReadmeGenerator.README_PLACEHOLDER_CONFIG`**:
    *   If a new placeholder needs static content from a file, add an entry mapping it to a `source_file` in `docs/sections/`. Create the new section file if needed.
    *   If a new placeholder needs dynamically generated content, add an entry mapping it to a `method_name`. Implement the corresponding method in the `ReadmeGenerator` class.
    *   Configure conditional rendering for new dynamic sections using `render_if_empty` and `empty_message` if necessary.
3.  **Update Section Files**: Edit files in `docs/sections/` if their content needs to change. These files can also contain placeholders that are processed by `_process_internal_placeholders()`.
4.  **Run `python generate_readme.py`** to apply changes.

---
(More developer guides will be added here, e.g., coding standards, testing strategy, release process.)
